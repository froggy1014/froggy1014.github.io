---
sidebar_position: 2
last_update:
  date: 3/06/2024
description: Huskyë¥¼ ì´ìš©í•œ pre-commit linting ì„¤ì •ê³¼ ì»¤ìŠ¤í…€í•œ ì»¤ë°‹ ì»¨ë²¤ì…˜ ì ìš©í•´ë³´ì•˜ìŠµë‹ˆë‹¤.
tags: [ìŠ¤í„°ë””]
---

# pre-commit Linting ì´ˆê¸° ì„¤ì •ê³¼ ì»¤ìŠ¤í…€

## ì„ í–‰ ì„¤ì¹˜ ë˜ì–´ì•¼í•  íŒ¨í‚¤ì§€ë“¤

```bash
npm install save-dev cz-conventional-changelog eslint husky lint-staged prettier
```

- eslint
- prettier
- cz-conventional-changelog ( commitizenì´ í¬í•¨ë˜ì–´ìˆìŒ )
  > ì»¨ë²¤ì…”ë„ì— ë”°ë¼ì„œ ë¨¼ì € ë§Œë“¤ì–´ë†“ì€ í”„ë¡¬í”„íŠ¸ ì…ë‹ˆë‹¤.
- husky
  > ì»¤ë°‹ ë©”ì‹œì§€, ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ë¦°íŠ¸í•˜ê³  ì»¤ë°‹ ë˜ëŠ” í‘¸ì‹œ ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•´ì¤ë‹ˆë‹¤.
- lint-staged
  > ë¦°í„°ë“¤ì´ ìŠ¤í…Œì´ì§•ëœ ê¹ƒ íŒŒì¼ë“¤ì„ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤ë‹ˆë‹¤.

## husky ì´ˆê¸° ì„¸íŒ…

```json
"scripts": {
    ...
    "prepare": "husky",
  },
```

```
npx husky init or npm run prepare
```

> ìœ„ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ huskyê°€ ì•Œì•„ì„œ ì´ˆê¸°í™” ì‘ì—…ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.

```md
/.husky
â£* /*
â£\_ pre-commit
```

ìœ„ì™€ ê°™ì€ êµ¬ì¡°ë¡œ í´ë”ê°€ í•˜ë‚˜ ìƒì„±ë©ë‹ˆë‹¤.

9 ë²„ì „ìœ¼ë¡œ ì˜¬ë¼ê°€ë©´ì„œ `/_` ë¼ëŠ” í´ë”ì•ˆì— `Stage`ë³„ íŒŒì¼ë“¤ì˜ ë¨¼ì € ìƒì„±ë˜ì–´ ìˆê³ , ë³¸ì¸ì´ í•„ìš”í•œê±°ë§Œ ë¹¼ì„œ `.husky` í´ë”ì•ˆì—ì„œ ë£¨íŠ¸ì— ì›í•˜ëŠ” `stage ì‹¤í–‰íŒŒì¼`ê³¼ `command` ë§Œ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤. ê¸°ì¡´ì—ëŠ” pathë„ ë„£ì–´ì¤˜ì•¼í–ˆë˜ê±° ê°™ì€ë° ì´ëŸ°ì‹ ê°œì„ ëœ ê²ƒ ê°™ì•„ ë³´ì…ë‹ˆë‹¤.

```bash
// pre-commit
npm test
```

ì²˜ìŒìœ¼ë¡œ ì´ˆê¸°í™”ë¥¼ í•˜ê²Œë˜ë©´ `pre-commit`ì´ë¼ëŠ” ì‹¤í–‰íŒŒì¼ ì•ˆì— `npm test` ë¼ëŠ” `command` í•˜ë‚˜ë§Œ ë“¤ì–´ê°€ê²Œ ë˜ëŠ”ë°, ì—¬ê¸°ì— `pre-commit` ìŠ¤í…Œì´ì§€ì— ì‚¬ìš©í•  `command`ë¥¼ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.

```bash
// pre-commit
npx lint-staged
```

ë°”ë¡œ ë‹¤ìŒì— ì‘ì—…í• ê±°ì§€ë§Œ ì¼ë‹¨ ìœ„ì™€ ê°™ì€ `npx lint-staged`ë¡œ ë¨¼ì € ë³€ê²½ì„ í•´ì£¼ì„¸ìš”.
ì €í¬ëŠ” ì´ë¯¸ `lint-sgaged`ë¥¼ ì„¤ì¹˜í•˜ì˜€ìŠµë‹ˆë‹¤. `script`ë¥¼ ì¶”ê°€í•´ì£¼ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```json
{
  "scripts": {
    "prepare": "husky",
  },
  "dependencies": {
    ...
  },
  "devDependencies": {
    "lint-staged": "^15.2.2",
  },
  "lint-staged": {
    "*.{ts,tsx}": [
      "eslint --fix",
      "prettier --write '**/*.{ts,tsx}' --ignore-unknown"
    ]
  }
}

```

ìœ„ì™€ ê°™ì´ lint-staged scriptë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”. í˜„ì¬ `staged` ëœ ì»¤ë°‹ì•ˆì— í¬í•¨ëœ íŒŒì¼ì— í•œí•˜ì—¬ ì°¨ë¡€ëŒ€ë¡œ `eslint`í•œë²ˆ ê²€ì‚¬í•´ì£¼ê³ , `prettier`ë¥¼ í†µí•´ì„œ í¬ë§·íŒ…ì„ í•´ì¤ë‹ˆë‹¤.

ì¼ë‹¨ ì—¬ê¸°ê¹Œì§€ë§Œ í•˜ë©´ pre-commit ìŠ¤í…Œì´ì§€ì—ì„œ lintingì„ ìë™í™”ê°€ ëœê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ ì™¸ì— ë³¸ì¸ì´ ë” ì¶”ê°€í•˜ê³  ì‹¶ì€ì‹ ê²Œ ìˆìœ¼ì‹œë‹¤ë©´ ë” ì¶”ê°€í•˜ì…”ë„ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

## ì»¤ë°‹ ì»¨ë²¤ì…˜ ê°•ì œí•˜ê¸°

```json
"scripts": {
    "cz": "cz",
  },
```

scriptì— ìœ„ì™€ ê°™ì´ ì¶”ê°€í•´ì¤ë‹ˆë‹¤. czëŠ” commitzenì˜ ì•½ì–´ì…ë‹ˆë‹¤. ìœ„ ì‹¤í–‰ì–´ë¥¼ í†µí•´ì„œ ì €í¬ëŠ” `commit`ì„ ì €í¬ê°€ ì›í•˜ëŠ” ê·œì¹™ì— ë§ê²Œ ì‚¬ìš©ìì—ê²Œ ìœ ë„ë¥¼ í•  ê²ƒ ì…ë‹ˆë‹¤.

- commitzen ì´ë€ ?
  > git commit ê´€ë¦¬ ë° í”„ë¡œì íŠ¸ versioning ìë™í™”ì— ìœ ìš©í•œ ë„êµ¬ë¼ê³  ìƒê°í•˜ì‹œë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ì•ì—ì„œ ì§„í–‰í•œ ê²ƒì€ `pre-commit` í›…ì€ ì»¤ë°‹í•  ë•Œ ê°€ì¥ ë¨¼ì € í˜¸ì¶œë˜ëŠ” í›…ìœ¼ë¡œ ì»¤ë°‹ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•˜ê¸° ì „ì— í˜¸ì¶œëœë‹¤. ì—¬ê¸°ì„œ ì§„í–‰í•  ê²ƒì€ `prepare-commit-msg` í›…ì…ë‹ˆë‹¤..

- `prepare-commit-msg` í›…ì´ë€ ?
  > prepare-commit-msg ëŠ” ê¸°ë³¸ ì»¤ë°‹ ë©”ì‹œì§€ê°€ ìƒì„±ëœ ì´í›„, ì»¤ë°‹ ë©”ì‹œì§€ í¸ì§‘ê¸°ê°€ ì‹¤í–‰ë˜ê¸° ì´ì „ ì‹œì ì— ì‹¤í–‰ë©ë‹ˆë‹¤.

```json
// package.json
"config": {
    "commitizen": {
      "path": "./node_modules/cz-conventional-changelog"
    }
  },
```

`cz-conventional-changelog` ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ configë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ëŠ” `conventional` ruleì„ ì ìš©ì‹œí‚¨ `commitizen`ì˜ ìœ„ì—ì„œ ë§Œë“¤ì–´ì§„ íŒŒìƒ íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— `peer-dependency`ë¡œ `commitizen`ì„¤ì¹˜ë˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ ì¶”ê°€í•´ì£¼ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

```md
/.husky
â£* /*
â£* pre-commit
â£* prepare-commit-msg <- here
```

`.husky` ì•„ë˜ `prepare-commit-msg`ë¥¼ íŒŒì¼ì„ ìƒì„±í•´ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì»¤ë§¨ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ë„£ì–´ì¤ë‹ˆë‹¤.

```bash
exec < /dev/tty && npx cz --hook || true
```

ê·¸ë¦¬ê³  ì´ì œ ë‹¤ì‹œ commitì„ í•˜ê²Œ ë˜ë©´ `conventional convention`ì´ ì ìš©ë˜ì–´ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`cz-conventional-changelog`ê°€ ë„ˆë¬´ íˆ¬ë¨¸ì¹˜ í•˜ë‹¤ê³  ìƒê°í•˜ì‹œë‚˜ìš”?

ë³¸ì¸ì´ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œë„ ì»¤ìŠ¤í…€ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
ì €ëŠ” ì•„ë˜ì™€ ê°™ì´ emojië¥¼ ì¶”ê°€í•´ì„œ ë§Œë“¤ì–´ë³´ì•˜ìŠµë‹ˆë‹¤.

```json
"config": {
    "commitizen": {
      "path": "./node_modules/cz-conventional-changelog",
      "types": {
        "âœ¨ Feat": {
          "description": "A new feature or enhancement",
          "title": "Feature"
        },
        "ğŸ› Fix": {
          "description": " A bug fix",
          "title": "Bug Fix"
        },
        "ğŸ“ docs": {
          "description": " Documentation changes",
          "title": "Documentation"
        },
        "ğŸ¨ Style": {
          "description": " Code style changes",
          "title": "Code Style"
        },
        "â™»ï¸ Refactor": {
          "description": "  Code refactoring",
          "title": "Code Refactoring"
        },
        "âœ… test": {
          "description": "Adding or modifying tests",
          "title": "Tests"
        },
        "ğŸš€ Deploy": {
          "description": " Deploying stuff",
          "title": "Deploy"
        },
        "ğŸ”§ Chore": {
          "description": " Other changes that don't modify src or test files",
          "title": "Chore"
        },
        "âš™ï¸ Settings": {
          "description": "  Changing configuration files",
          "title": "Settings"
        }
      }
    }
}
```

## ë” ì¶”ê°€í•´ì•¼í•˜ëŠ” ì‘ì—…

> pre-commitì´ë‘ prepare-commit-msgë„ ìë™ ìƒì„± ë° ì»¤ë§¨ë“œ ì‚½ì… ìë™í™”
